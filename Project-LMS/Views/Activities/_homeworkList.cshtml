@model List<Project_LMS.Models.HomeworkViewModels>

@{
    var studentList = Model.Select(s => s.Students).FirstOrDefault().ToList();
    var docList = Model.Select(s => s.Documents).FirstOrDefault().ToList();
}

<h3>Homework and Feedback</h3>
<br/>

<table class="table">
    <tr>
        <th>Student Name</th>
        <th>Document</th>
        <th>Feedback</th>
        <th></th>
    </tr>

    @foreach (var student in studentList)
    {
        var doc = docList.FirstOrDefault(d => d.ApplicationUser.UserName == student.UserName);
        <tr>
            <td>@Html.Raw(student.GivenName + " " + student.FamilyName)</td>
            <td>
                @if (doc != null)
                {
                    @Html.Raw(doc.DocumentName);
                }
                else
                {
                    <div style="color: red"><i class="glyphicon glyphicon-ban-circle"></i>@Html.Raw(" No file detected")</div>
                }
            </td>
            <td>
                @if (doc != null)
                {
                    if (doc.FeedBack != null)
                    {
                        <div style="color: blue"><i class="glyphicon glyphicon-thumbs-up"></i>@Html.Raw(" Feedback done")</div>
                    }
                    else
                    {
                        <div style="color: red"><i class="glyphicon glyphicon-ban-circle"></i>@Html.Raw(" No feedback given")</div>
                    }
                }
            </td>
            <td>
                @if (doc != null)
                {
                    <a href="@Url.Action("DownLoadFile", "Documents", new { id = doc.DocumentId })" class="btn btn-info">
                        <i class="glyphicon glyphicon-bullhorn"></i>
                        <span>
                            <strong>Add/Edit Feedback</strong>
                        </span>
                    </a>
                    <a href="@Url.Action("DownLoadFile", "Documents", new { id = doc.DocumentId })" class="btn btn-success">
                        <i class="glyphicon glyphicon-download"></i>
                        <span>
                            <strong>Download</strong>
                        </span>
                    </a>

                }
            </td>
        </tr>
    }

</table>